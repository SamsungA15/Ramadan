<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸŒ™ ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø³Ù„Ù…</title>

<link rel="manifest" href="manifest.json">

<style>
body {
  margin: 0;
  font-family: Tahoma, Arial;
  background: #020617;
  color: #f8fafc;
}

header {
  text-align: center;
  padding: 15px;
  border-bottom: 1px solid #1e293b;
}

nav {
  display: flex;
  justify-content: space-around;
  padding: 10px;
  border-bottom: 1px solid #1e293b;
}

nav button {
  background: #0f172a;
  color: white;
  border: none;
  padding: 10px 15px;
  border-radius: 12px;
  cursor: pointer;
}

section {
  display: none;
  padding: 20px;
}

section.active {
  display: block;
}

.ayah {
  background: #0f172a;
  padding: 15px;
  margin-bottom: 10px;
  border-radius: 15px;
  line-height: 2;
}

select, button {
  width: 100%;
  padding: 10px;
  border-radius: 12px;
  margin-bottom: 10px;
}

.counter {
  font-size: 60px;
  text-align: center;
}

.arrow {
  width: 0;
  height: 0;
  border-left: 30px solid transparent;
  border-right: 30px solid transparent;
  border-bottom: 120px solid red;
  margin: 40px auto;
  transition: transform 0.6s ease;
}
</style>
</head>

<body>

<header>
  <h2>ğŸ“– ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ù…Ø³Ù„Ù…</h2>
</header>

<nav>
  <button onclick="showPage('quran')">Ø§Ù„Ù‚Ø±Ø¢Ù†</button>
  <button onclick="showPage('azkar')">Ø§Ù„Ø£Ø°ÙƒØ§Ø±</button>
  <button onclick="showPage('tasbeeh')">Ø§Ù„Ù…Ø³Ø¨Ø­Ø©</button>
  <button onclick="showPage('qibla')">Ø§Ù„Ù‚Ø¨Ù„Ø©</button>
</nav>

<!-- ===== Ø§Ù„Ù‚Ø±Ø¢Ù† ===== -->
<section id="quran" class="active">
  <select id="surahSelect"></select>
  <div id="ayahs"></div>
</section>

<!-- ===== Ø§Ù„Ø£Ø°ÙƒØ§Ø± ===== -->
<section id="azkar">
  <div class="ayah">ğŸŒ… Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­: Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡ ÙˆØ¨Ø­Ù…Ø¯Ù‡ 100 Ù…Ø±Ø©</div>
  <div class="ayah">ğŸŒ™ Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡: Ø£Ø¹ÙˆØ° Ø¨ÙƒÙ„Ù…Ø§Øª Ø§Ù„Ù„Ù‡ Ø§Ù„ØªØ§Ù…Ø§Øª</div>
  <div class="ayah">ğŸ›Œ Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù†ÙˆÙ…: Ø¨Ø§Ø³Ù…Ùƒ Ø±Ø¨ÙŠ ÙˆØ¶Ø¹Øª Ø¬Ù†Ø¨ÙŠ</div>
  <div class="ayah">ğŸŒ™ Ù„ÙŠÙ„Ø© Ø§Ù„Ù‚Ø¯Ø±: Ø§Ù„Ù„Ù‡Ù… Ø¥Ù†Ùƒ Ø¹ÙÙˆ ØªØ­Ø¨ Ø§Ù„Ø¹ÙÙˆ ÙØ§Ø¹Ù Ø¹Ù†ÙŠ</div>
  <div class="ayah">ğŸ•Œ Ø±Ù…Ø¶Ø§Ù†: Ø§Ù„Ù„Ù‡Ù… Ø¨Ù„ØºÙ†Ø§ Ø±Ù…Ø¶Ø§Ù†</div>
</section>

<!-- ===== Ø§Ù„Ù…Ø³Ø¨Ø­Ø© ===== -->
<section id="tasbeeh">
  <select onchange="changeTasbeeh(this.value)">
    <option>Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡</option>
    <option>Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡</option>
    <option>Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø±</option>
    <option>Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡</option>
    <option>Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡ ÙˆØ¨Ø­Ù…Ø¯Ù‡</option>
  </select>

  <div id="tasbeehText" style="text-align:center;">Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡</div>
  <div id="count" class="counter">0</div>
  <button onclick="increment()">ØªØ³Ø¨ÙŠØ­</button>
  <button onclick="reset()">ØªØµÙÙŠØ±</button>
</section>

<!-- ===== Ø§Ù„Ù‚Ø¨Ù„Ø© ===== -->
<section id="qibla">
  <h3 style="text-align:center">ğŸ•‹ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù‚Ø¨Ù„Ø©</h3>
  <div class="arrow" id="needle"></div>
  <div id="qiblaStatus" style="text-align:center">Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹Ùƒâ€¦</div>
</section>

<!-- ===== Ø§Ù„Ù‚Ø±Ø¢Ù† ===== -->
<script src="quran.js"></script>

<script>
function showPage(id) {
  document.querySelectorAll("section").forEach(s => s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

/* ===== Ø§Ù„Ù…Ø³Ø¨Ø­Ø© ===== */
let count = 0;
function increment() {
  count++;
  document.getElementById("count").textContent = count;
}
function reset() {
  count = 0;
  document.getElementById("count").textContent = 0;
}
function changeTasbeeh(text) {
  document.getElementById("tasbeehText").textContent = text;
  reset();
}

/* ===== Ø§Ù„Ù‚Ø±Ø¢Ù† ===== */
const surahSelect = document.getElementById("surahSelect");
const ayahsDiv = document.getElementById("ayahs");

if (Array.isArray(window.quran)) {
  window.quran.forEach((s, i) => {
    const opt = document.createElement("option");
    opt.value = i;
    opt.textContent = s.name;
    surahSelect.appendChild(opt);
  });

  function loadSurah(i) {
    ayahsDiv.innerHTML = "";
    window.quran[i].verses.forEach(v => {
      ayahsDiv.innerHTML += `<div class="ayah">${v.text} ï´¿${v.id}ï´¾</div>`;
    });
    ayahsDiv.innerHTML += `<div class="ayah">ØµØ¯Ù‚ Ø§Ù„Ù„Ù‡ Ø§Ù„Ø¹Ø¸ÙŠÙ…</div>`;
  }

  surahSelect.onchange = e => loadSurah(e.target.value);
  loadSurah(0);
}

/* ===== Ø§Ù„Ù‚Ø¨Ù„Ø© Ø§Ù„Ø¯Ù‚ÙŠÙ‚Ø© (Ù…ÙƒØ©) ===== */
const KAABA_LAT = 21.422487;
const KAABA_LON = 39.826206;

function toRad(d){return d*Math.PI/180;}
function toDeg(r){return r*180/Math.PI;}

navigator.geolocation.getCurrentPosition(pos => {
  const lat = pos.coords.latitude;
  const lon = pos.coords.longitude;

  const Ï†1 = toRad(lat);
  const Ï†2 = toRad(KAABA_LAT);
  const Î”Î» = toRad(KAABA_LON - lon);

  const y = Math.sin(Î”Î»);
  const x = Math.cos(Ï†1)*Math.tan(Ï†2) - Math.sin(Ï†1)*Math.cos(Î”Î»);
  const angle = (toDeg(Math.atan2(y, x)) + 360) % 360;

  document.getElementById("needle").style.transform = `rotate(${angle}deg)`;
  document.getElementById("qiblaStatus").textContent = "Ø§ØªØ¬Ù‡ Ù†Ø­Ùˆ Ø§Ù„Ø³Ù‡Ù… Ù„Ù„Ù‚Ø¨Ù„Ø©";
}, () => {
  document.getElementById("qiblaStatus").textContent = "ÙØ´Ù„ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹";
});
</script>

</body>
</html>
