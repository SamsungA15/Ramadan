<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ØªØ·Ø¨ÙŠÙ‚ Ø¥Ø³Ù„Ø§Ù…ÙŠ Ø´Ø§Ù…Ù„</title>

<style>
body {
  margin: 0;
  font-family: "Amiri", serif;
  background: #111;
  color: #fff;
}
header {
  background: #000;
  padding: 15px;
  text-align: center;
  font-size: 22px;
}
nav {
  display: flex;
  background: #222;
}
nav button {
  flex: 1;
  padding: 12px;
  background: none;
  border: none;
  color: #fff;
  font-size: 16px;
  cursor: pointer;
}
nav button:hover { background: #333; }
.page { display: none; padding: 15px; }
.page.active { display: block; }
select {
  width: 100%;
  padding: 10px;
  font-size: 18px;
  margin-bottom: 15px;
}
.ayah {
  background: #1c1c1c;
  margin-bottom: 10px;
  padding: 15px;
  border-radius: 8px;
  font-size: 20px;
  line-height: 1.9;
}
h3 { margin-top: 30px; color: #ffd700; }
.counter { font-size: 42px; text-align: center; margin: 20px 0; }
.tasbeeh-btn {
  width: 100%;
  padding: 15px;
  font-size: 20px;
  background: #444;
  color: #fff;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  margin-bottom: 10px;
}
.reset { background: #a00; }
</style>
</head>

<body>

<header>ğŸ“– ØªØ·Ø¨ÙŠÙ‚ Ø¥Ø³Ù„Ø§Ù…ÙŠ Ø´Ø§Ù…Ù„</header>

<nav>
  <button onclick="showPage('quran')">Ø§Ù„Ù‚Ø±Ø¢Ù†</button>
  <button onclick="showPage('adhkar')">Ø§Ù„Ø£Ø°ÙƒØ§Ø±</button>
  <button onclick="showPage('tasbeeh')">Ø§Ù„Ù…Ø³Ø¨Ø­Ø©</button>
  <button onclick="showPage('qibla')">Ø§Ù„Ù‚Ø¨Ù„Ø©</button>
</nav>

<!-- Ø§Ù„Ù‚Ø±Ø¢Ù† -->
<div id="quran" class="page active">
  <select id="surahSelect"></select>
  <div id="ayahs"></div>
</div>

<!-- Ø§Ù„Ø£Ø°ÙƒØ§Ø± -->
<div id="adhkar" class="page">
<h3>ğŸŒ… Ø£Ø°ÙƒØ§Ø± Ø§Ù„ØµØ¨Ø§Ø­</h3>
<div class="ayah">Ø£ØµØ¨Ø­Ù†Ø§ ÙˆØ£ØµØ¨Ø­ Ø§Ù„Ù…Ù„Ùƒ Ù„Ù„Ù‡ ÙˆØ§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡...</div>
<div class="ayah">Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡ ÙˆØ¨Ø­Ù…Ø¯Ù‡ (100 Ù…Ø±Ø©)</div>

<h3>ğŸŒ™ Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù…Ø³Ø§Ø¡</h3>
<div class="ayah">Ø£Ù…Ø³ÙŠÙ†Ø§ ÙˆØ£Ù…Ø³Ù‰ Ø§Ù„Ù…Ù„Ùƒ Ù„Ù„Ù‡...</div>

<h3>ğŸ›ï¸ Ø£Ø°ÙƒØ§Ø± Ø§Ù„Ù†ÙˆÙ…</h3>
<div class="ayah">Ø¨Ø§Ø³Ù…Ùƒ Ø§Ù„Ù„Ù‡Ù… Ø£Ù…ÙˆØª ÙˆØ£Ø­ÙŠØ§</div>

<h3>âœ¨ Ø£Ø°ÙƒØ§Ø± Ù„ÙŠÙ„Ø© Ø§Ù„Ù‚Ø¯Ø±</h3>
<div class="ayah">Ø§Ù„Ù„Ù‡Ù… Ø¥Ù†Ùƒ Ø¹ÙÙˆ ØªØ­Ø¨ Ø§Ù„Ø¹ÙÙˆ ÙØ§Ø¹ÙÙ Ø¹Ù†ÙŠ</div>

<h3>ğŸ“¿ Ø£Ø°ÙƒØ§Ø± Ø¹Ø§Ù…Ø©</h3>
<div class="ayah">Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡</div>
<div class="ayah">Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡</div>
<div class="ayah">Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø±</div>
</div>

<!-- Ø§Ù„Ù…Ø³Ø¨Ø­Ø© -->
<div id="tasbeeh" class="page">
<select onchange="changeTasbeeh(this.value)">
  <option>Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡</option>
  <option>Ø§Ù„Ø­Ù…Ø¯ Ù„Ù„Ù‡</option>
  <option>Ø§Ù„Ù„Ù‡ Ø£ÙƒØ¨Ø±</option>
  <option>Ù„Ø§ Ø¥Ù„Ù‡ Ø¥Ù„Ø§ Ø§Ù„Ù„Ù‡</option>
  <option>Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡ ÙˆØ¨Ø­Ù…Ø¯Ù‡</option>
  <option>Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡ Ø§Ù„Ø¹Ø¸ÙŠÙ…</option>
  <option>Ø£Ø³ØªØºÙØ± Ø§Ù„Ù„Ù‡</option>
  <option>Ù„Ø§ Ø­ÙˆÙ„ ÙˆÙ„Ø§ Ù‚ÙˆØ© Ø¥Ù„Ø§ Ø¨Ø§Ù„Ù„Ù‡</option>
</select>

<div id="tasbeehText" class="ayah">Ø³Ø¨Ø­Ø§Ù† Ø§Ù„Ù„Ù‡</div>
<div id="count" class="counter">0</div>

<button class="tasbeeh-btn" onclick="increment()">ğŸ“¿ ØªØ³Ø¨ÙŠØ­</button>
<button class="tasbeeh-btn reset" onclick="reset()">ğŸ”„ ØªØµÙÙŠØ±</button>
</div>

<!-- Ø§Ù„Ù‚Ø¨Ù„Ø© -->
<div id="qibla" class="page">
<h3>ğŸ•‹ Ø§ØªØ¬Ø§Ù‡ Ø§Ù„Ù‚Ø¨Ù„Ø©</h3>

<div style="text-align:center;margin-top:30px">
  <div id="qiblaArrow"
    style="
      width:0;height:0;
      border-left:30px solid transparent;
      border-right:30px solid transparent;
      border-bottom:90px solid red;
      margin:0 auto;
      transform-origin:50% 100%;
      transition:transform .2s">
  </div>
  <p id="qiblaStatus" style="margin-top:20px">Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ¯ Ù…ÙˆÙ‚Ø¹Ùƒ...</p>
</div>
</div>

<script src="quran.js"></script>

<script>
// Ø§Ù„ØµÙØ­Ø§Øª
function showPage(id){
  document.querySelectorAll(".page").forEach(p=>p.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

// Ø§Ù„Ù‚Ø±Ø¢Ù†
document.addEventListener("DOMContentLoaded",()=>{
  const surahSelect=document.getElementById("surahSelect");
  const ayahsDiv=document.getElementById("ayahs");

  quran.forEach((s,i)=>{
    const o=document.createElement("option");
    o.value=i;
    o.textContent=s.name;
    surahSelect.appendChild(o);
  });

  function loadSurah(i){
    ayahsDiv.innerHTML="";
    quran[i].verses.forEach(v=>{
      const d=document.createElement("div");
      d.className="ayah";
      d.textContent=`${v.text} ï´¿${v.id}ï´¾`;
      ayahsDiv.appendChild(d);
    });
    ayahsDiv.innerHTML+="<div class='ayah'>ØµØ¯Ù‚ Ø§Ù„Ù„Ù‡ Ø§Ù„Ø¹Ø¸ÙŠÙ…</div>";
  }

  surahSelect.onchange=e=>loadSurah(e.target.value);
  loadSurah(0);
});

// Ø§Ù„Ù…Ø³Ø¨Ø­Ø©
let count=0;
function increment(){ document.getElementById("count").textContent=++count; }
function reset(){ count=0; document.getElementById("count").textContent=0; }
function changeTasbeeh(t){ document.getElementById("tasbeehText").textContent=t; reset(); }

// Ø§Ù„Ù‚Ø¨Ù„Ø© Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ©
const KAABA_LAT=21.4225, KAABA_LON=39.8262;
let lat=null, lon=null, heading=0, vibrated=false;

const rad=d=>d*Math.PI/180, deg=r=>r*180/Math.PI;

function qiblaAngle(){
  const dLon=rad(KAABA_LON-lon);
  const y=Math.sin(dLon);
  const x=Math.cos(rad(lat))*Math.tan(rad(KAABA_LAT))-Math.sin(rad(lat))*Math.cos(dLon);
  return (deg(Math.atan2(y,x))+360)%360;
}

function updateQibla(){
  if(lat==null) return;
  const angle=qiblaAngle()-heading;
  document.getElementById("qiblaArrow").style.transform=`rotate(${angle}deg)`;

  const diff=Math.abs(((angle+180)%360)-180);
  const status=document.getElementById("qiblaStatus");

  if(diff<7){
    status.textContent="âœ… Ø£Ù†Øª Ø§Ù„Ø¢Ù† Ù…ØªØ¬Ù‡ Ù†Ø­Ùˆ Ø§Ù„Ù‚Ø¨Ù„Ø©";
    status.style.color="#0f0";
    if(navigator.vibrate && !vibrated){
      navigator.vibrate(200);
      vibrated=true;
    }
  } else {
    status.textContent="Ø­Ø±Ù‘Ùƒ Ø§Ù„Ù‡Ø§ØªÙ Ø­ØªÙ‰ ÙŠØ´ÙŠØ± Ø§Ù„Ø³Ù‡Ù… Ù„Ù„Ø£Ø¹Ù„Ù‰";
    status.style.color="#fff";
    vibrated=false;
  }
}

navigator.geolocation.getCurrentPosition(p=>{
  lat=p.coords.latitude;
  lon=p.coords.longitude;
},()=>{});

window.addEventListener("deviceorientation",e=>{
  if(e.webkitCompassHeading!=null) heading=e.webkitCompassHeading;
  else if(e.alpha!=null) heading=360-e.alpha;
  updateQibla();
});
</script>

</body>
</html>
